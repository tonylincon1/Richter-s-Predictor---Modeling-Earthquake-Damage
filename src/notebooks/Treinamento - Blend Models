{"cells":[{"cell_type":"markdown","source":["# Preparações"],"metadata":{"id":"S1SjD-NU1pmB"}},{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":7747,"status":"ok","timestamp":1654047266390,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"_7vsZu4J0Jyk"},"outputs":[],"source":["!pip install pycaret==2.3.10 markupsafe==2.0.1 pyyaml==5.4.1 -qq"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3259,"status":"ok","timestamp":1654047269643,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"TA9o4Sc6Qc6I","outputId":"df4cf313-33a6-4013-b2e9-3a52fd704118"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/distributed/config.py:20: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.\n","  defaults = yaml.load(f)\n"]}],"source":["import pandas as pd\n","from pycaret.classification import *\n","from tqdm import tqdm"]},{"cell_type":"code","source":["from google.colab import drive\n","\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pbmv4QPG2mlV","executionInfo":{"status":"ok","timestamp":1654047271769,"user_tz":180,"elapsed":2130,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"38871414-0b7b-4413-e2c0-cd844dfbf60b"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"markdown","metadata":{"id":"EzuQlWAIdlLY"},"source":["# Preparação"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":793,"status":"ok","timestamp":1654047272557,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"SmglVpXXQx7w"},"outputs":[],"source":["df_train_values = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/train_values.csv\")"]},{"cell_type":"code","execution_count":5,"metadata":{"executionInfo":{"elapsed":613,"status":"ok","timestamp":1654047273166,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"-owqop2mQ46i"},"outputs":[],"source":["df_train__label_values = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/train_labels.csv\")"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":270},"executionInfo":{"elapsed":22,"status":"ok","timestamp":1654047273167,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"71GSlzD9Q7cY","outputId":"44b53408-24b2-458d-cfa6-3deae8ec6092"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   building_id  geo_level_1_id  geo_level_2_id  geo_level_3_id  \\\n","0       802906               6             487           12198   \n","1        28830               8             900            2812   \n","2        94947              21             363            8973   \n","3       590882              22             418           10694   \n","4       201944              11             131            1488   \n","\n","   count_floors_pre_eq  age  area_percentage  height_percentage  \\\n","0                    2   30                6                  5   \n","1                    2   10                8                  7   \n","2                    2   10                5                  5   \n","3                    2   10                6                  5   \n","4                    3   30                8                  9   \n","\n","  land_surface_condition foundation_type roof_type ground_floor_type  \\\n","0                      t               r         n                 f   \n","1                      o               r         n                 x   \n","2                      t               r         n                 f   \n","3                      t               r         n                 f   \n","4                      t               r         n                 f   \n","\n","  other_floor_type position plan_configuration  has_superstructure_adobe_mud  \\\n","0                q        t                  d                             1   \n","1                q        s                  d                             0   \n","2                x        t                  d                             0   \n","3                x        s                  d                             0   \n","4                x        s                  d                             1   \n","\n","   has_superstructure_mud_mortar_stone  has_superstructure_stone_flag  \\\n","0                                    1                              0   \n","1                                    1                              0   \n","2                                    1                              0   \n","3                                    1                              0   \n","4                                    0                              0   \n","\n","   has_superstructure_cement_mortar_stone  \\\n","0                                       0   \n","1                                       0   \n","2                                       0   \n","3                                       0   \n","4                                       0   \n","\n","   has_superstructure_mud_mortar_brick  \\\n","0                                    0   \n","1                                    0   \n","2                                    0   \n","3                                    0   \n","4                                    0   \n","\n","   has_superstructure_cement_mortar_brick  has_superstructure_timber  \\\n","0                                       0                          0   \n","1                                       0                          0   \n","2                                       0                          0   \n","3                                       0                          1   \n","4                                       0                          0   \n","\n","   has_superstructure_bamboo  has_superstructure_rc_non_engineered  \\\n","0                          0                                     0   \n","1                          0                                     0   \n","2                          0                                     0   \n","3                          1                                     0   \n","4                          0                                     0   \n","\n","   has_superstructure_rc_engineered  has_superstructure_other  \\\n","0                                 0                         0   \n","1                                 0                         0   \n","2                                 0                         0   \n","3                                 0                         0   \n","4                                 0                         0   \n","\n","  legal_ownership_status  count_families  has_secondary_use  \\\n","0                      v               1                  0   \n","1                      v               1                  0   \n","2                      v               1                  0   \n","3                      v               1                  0   \n","4                      v               1                  0   \n","\n","   has_secondary_use_agriculture  has_secondary_use_hotel  \\\n","0                              0                        0   \n","1                              0                        0   \n","2                              0                        0   \n","3                              0                        0   \n","4                              0                        0   \n","\n","   has_secondary_use_rental  has_secondary_use_institution  \\\n","0                         0                              0   \n","1                         0                              0   \n","2                         0                              0   \n","3                         0                              0   \n","4                         0                              0   \n","\n","   has_secondary_use_school  has_secondary_use_industry  \\\n","0                         0                           0   \n","1                         0                           0   \n","2                         0                           0   \n","3                         0                           0   \n","4                         0                           0   \n","\n","   has_secondary_use_health_post  has_secondary_use_gov_office  \\\n","0                              0                             0   \n","1                              0                             0   \n","2                              0                             0   \n","3                              0                             0   \n","4                              0                             0   \n","\n","   has_secondary_use_use_police  has_secondary_use_other  \n","0                             0                        0  \n","1                             0                        0  \n","2                             0                        0  \n","3                             0                        0  \n","4                             0                        0  "],"text/html":["\n","  <div id=\"df-a3b94601-fd42-4540-8f68-65906b59fb1d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>building_id</th>\n","      <th>geo_level_1_id</th>\n","      <th>geo_level_2_id</th>\n","      <th>geo_level_3_id</th>\n","      <th>count_floors_pre_eq</th>\n","      <th>age</th>\n","      <th>area_percentage</th>\n","      <th>height_percentage</th>\n","      <th>land_surface_condition</th>\n","      <th>foundation_type</th>\n","      <th>roof_type</th>\n","      <th>ground_floor_type</th>\n","      <th>other_floor_type</th>\n","      <th>position</th>\n","      <th>plan_configuration</th>\n","      <th>has_superstructure_adobe_mud</th>\n","      <th>has_superstructure_mud_mortar_stone</th>\n","      <th>has_superstructure_stone_flag</th>\n","      <th>has_superstructure_cement_mortar_stone</th>\n","      <th>has_superstructure_mud_mortar_brick</th>\n","      <th>has_superstructure_cement_mortar_brick</th>\n","      <th>has_superstructure_timber</th>\n","      <th>has_superstructure_bamboo</th>\n","      <th>has_superstructure_rc_non_engineered</th>\n","      <th>has_superstructure_rc_engineered</th>\n","      <th>has_superstructure_other</th>\n","      <th>legal_ownership_status</th>\n","      <th>count_families</th>\n","      <th>has_secondary_use</th>\n","      <th>has_secondary_use_agriculture</th>\n","      <th>has_secondary_use_hotel</th>\n","      <th>has_secondary_use_rental</th>\n","      <th>has_secondary_use_institution</th>\n","      <th>has_secondary_use_school</th>\n","      <th>has_secondary_use_industry</th>\n","      <th>has_secondary_use_health_post</th>\n","      <th>has_secondary_use_gov_office</th>\n","      <th>has_secondary_use_use_police</th>\n","      <th>has_secondary_use_other</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>802906</td>\n","      <td>6</td>\n","      <td>487</td>\n","      <td>12198</td>\n","      <td>2</td>\n","      <td>30</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>n</td>\n","      <td>f</td>\n","      <td>q</td>\n","      <td>t</td>\n","      <td>d</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>v</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>28830</td>\n","      <td>8</td>\n","      <td>900</td>\n","      <td>2812</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>o</td>\n","      <td>r</td>\n","      <td>n</td>\n","      <td>x</td>\n","      <td>q</td>\n","      <td>s</td>\n","      <td>d</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>v</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>94947</td>\n","      <td>21</td>\n","      <td>363</td>\n","      <td>8973</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>n</td>\n","      <td>f</td>\n","      <td>x</td>\n","      <td>t</td>\n","      <td>d</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>v</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>590882</td>\n","      <td>22</td>\n","      <td>418</td>\n","      <td>10694</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>n</td>\n","      <td>f</td>\n","      <td>x</td>\n","      <td>s</td>\n","      <td>d</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>v</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>201944</td>\n","      <td>11</td>\n","      <td>131</td>\n","      <td>1488</td>\n","      <td>3</td>\n","      <td>30</td>\n","      <td>8</td>\n","      <td>9</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>n</td>\n","      <td>f</td>\n","      <td>x</td>\n","      <td>s</td>\n","      <td>d</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>v</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a3b94601-fd42-4540-8f68-65906b59fb1d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a3b94601-fd42-4540-8f68-65906b59fb1d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a3b94601-fd42-4540-8f68-65906b59fb1d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}],"source":["df_train_values.head()"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":19,"status":"ok","timestamp":1654047273168,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"nuqKEYpoQ-A-","outputId":"2f9c4d2c-3730-4881-fe18-d0b537274e18"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   building_id  damage_grade\n","0       802906             3\n","1        28830             2\n","2        94947             3\n","3       590882             2\n","4       201944             3"],"text/html":["\n","  <div id=\"df-52641e1b-845a-4301-b709-659c34d7ad59\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>building_id</th>\n","      <th>damage_grade</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>802906</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>28830</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>94947</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>590882</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>201944</td>\n","      <td>3</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-52641e1b-845a-4301-b709-659c34d7ad59')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-52641e1b-845a-4301-b709-659c34d7ad59 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-52641e1b-845a-4301-b709-659c34d7ad59');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":7}],"source":["df_train__label_values.head()"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16,"status":"ok","timestamp":1654047273168,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"U7mZTZ7_Q_5u","outputId":"7b795458-f276-4e59-fca5-2bc451ed796d"},"outputs":[{"output_type":"stream","name":"stdout","text":["(260601, 39)\n","(260601, 2)\n"]}],"source":["print(df_train_values.shape)\n","print(df_train__label_values.shape)"]},{"cell_type":"code","execution_count":9,"metadata":{"executionInfo":{"elapsed":15,"status":"ok","timestamp":1654047273169,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"gHl8gsL0RBqS"},"outputs":[],"source":["df_train = pd.merge(df_train_values,df_train__label_values,how='inner',on='building_id')"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14,"status":"ok","timestamp":1654047273169,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"kGjxs-YNRDUq","outputId":"515507ac-a3c9-443f-8e9e-3bed602fa9da"},"outputs":[{"output_type":"stream","name":"stdout","text":["(260601, 39)\n","(260601, 2)\n","(260601, 40)\n"]}],"source":["print(df_train_values.shape)\n","print(df_train__label_values.shape)\n","print(df_train.shape)"]},{"cell_type":"code","execution_count":11,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":516,"status":"ok","timestamp":1654047273673,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"wiIxHVBEREho","outputId":"e4051826-d8ac-43c3-8b41-4c98bcd502b4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["2    148259\n","3     87218\n","1     25124\n","Name: damage_grade, dtype: int64"]},"metadata":{},"execution_count":11}],"source":["df_train.damage_grade.value_counts()"]},{"cell_type":"code","execution_count":12,"metadata":{"executionInfo":{"elapsed":17,"status":"ok","timestamp":1654047273674,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"XUiEdyyDRIzb"},"outputs":[],"source":["target = []\n","\n","for n in df_train.damage_grade:\n","    if n == 1:\n","        target.append(0)\n","    elif n == 2:\n","        target.append(1)\n","    elif n == 3:\n","        target.append(2)"]},{"cell_type":"code","execution_count":13,"metadata":{"executionInfo":{"elapsed":16,"status":"ok","timestamp":1654047273675,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"akbaNL-ZRLBG"},"outputs":[],"source":["df_train[\"damage_grade\"] = target"]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16,"status":"ok","timestamp":1654047273676,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"4y8zYaYYRNEt","outputId":"7bf996cd-9d12-4f8c-d23c-a18a1209c935"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["1    148259\n","2     87218\n","0     25124\n","Name: damage_grade, dtype: int64"]},"metadata":{},"execution_count":14}],"source":["df_train.damage_grade.value_counts()"]},{"cell_type":"markdown","metadata":{"id":"TDKD1ZGsRaHt"},"source":["# Treinamento 1 - Soft"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["cdf0189aa6e1416db336200608e76c50","4764c84e817f4f848489bca3842e065a","ecd5107fab5c4e6c8e085d6f61ac8bcb"]},"executionInfo":{"elapsed":58605,"status":"ok","timestamp":1654047332267,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"dqCvkq48RX4a","outputId":"87563cf9-4e1b-44c0-efa5-9c7de758b839"},"outputs":[{"output_type":"display_data","data":{"text/plain":["                               Description             Value\n","0                               session_id               786\n","1                                   Target      damage_grade\n","2                              Target Type        Multiclass\n","3                            Label Encoded              None\n","4                            Original Data      (260601, 40)\n","5                           Missing Values             False\n","6                         Numeric Features                 7\n","7                     Categorical Features                32\n","8                         Ordinal Features             False\n","9                High Cardinality Features             False\n","10                 High Cardinality Method              None\n","11                   Transformed Train Set      (182420, 86)\n","12                    Transformed Test Set       (78181, 86)\n","13                      Shuffle Train-Test              True\n","14                     Stratify Train-Test             False\n","15                          Fold Generator   StratifiedKFold\n","16                             Fold Number                10\n","17                                CPU Jobs                -1\n","18                                 Use GPU              True\n","19                          Log Experiment             False\n","20                         Experiment Name  clf-default-name\n","21                                     USI              6e5b\n","22                         Imputation Type            simple\n","23          Iterative Imputation Iteration              None\n","24                         Numeric Imputer              mean\n","25      Iterative Imputation Numeric Model              None\n","26                     Categorical Imputer          constant\n","27  Iterative Imputation Categorical Model              None\n","28           Unknown Categoricals Handling    least_frequent\n","29                               Normalize             False\n","30                        Normalize Method              None\n","31                          Transformation             False\n","32                   Transformation Method              None\n","33                                     PCA             False\n","34                              PCA Method              None\n","35                          PCA Components              None\n","36                     Ignore Low Variance             False\n","37                     Combine Rare Levels             False\n","38                    Rare Level Threshold              None\n","39                         Numeric Binning             False\n","40                         Remove Outliers             False\n","41                      Outliers Threshold              None\n","42                Remove Multicollinearity             False\n","43             Multicollinearity Threshold              None\n","44             Remove Perfect Collinearity              True\n","45                              Clustering             False\n","46                    Clustering Iteration              None\n","47                     Polynomial Features             False\n","48                       Polynomial Degree              None\n","49                    Trignometry Features             False\n","50                    Polynomial Threshold              None\n","51                          Group Features             False\n","52                       Feature Selection             False\n","53                Feature Selection Method           classic\n","54            Features Selection Threshold              None\n","55                     Feature Interaction             False\n","56                           Feature Ratio             False\n","57                   Interaction Threshold              None\n","58                           Fix Imbalance             False\n","59                    Fix Imbalance Method             SMOTE"],"text/html":["\n","  <div id=\"df-483b71a0-88dc-4e72-ae8a-c8a0a8481383\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Description</th>\n","      <th>Value</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>session_id</td>\n","      <td>786</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Target</td>\n","      <td>damage_grade</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Target Type</td>\n","      <td>Multiclass</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Label Encoded</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Original Data</td>\n","      <td>(260601, 40)</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Missing Values</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Numeric Features</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Categorical Features</td>\n","      <td>32</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Ordinal Features</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>High Cardinality Features</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>High Cardinality Method</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Transformed Train Set</td>\n","      <td>(182420, 86)</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Transformed Test Set</td>\n","      <td>(78181, 86)</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Shuffle Train-Test</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Stratify Train-Test</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Fold Generator</td>\n","      <td>StratifiedKFold</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Fold Number</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>CPU Jobs</td>\n","      <td>-1</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>Use GPU</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>19</th>\n","      <td>Log Experiment</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>20</th>\n","      <td>Experiment Name</td>\n","      <td>clf-default-name</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>USI</td>\n","      <td>6e5b</td>\n","    </tr>\n","    <tr>\n","      <th>22</th>\n","      <td>Imputation Type</td>\n","      <td>simple</td>\n","    </tr>\n","    <tr>\n","      <th>23</th>\n","      <td>Iterative Imputation Iteration</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>24</th>\n","      <td>Numeric Imputer</td>\n","      <td>mean</td>\n","    </tr>\n","    <tr>\n","      <th>25</th>\n","      <td>Iterative Imputation Numeric Model</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>26</th>\n","      <td>Categorical Imputer</td>\n","      <td>constant</td>\n","    </tr>\n","    <tr>\n","      <th>27</th>\n","      <td>Iterative Imputation Categorical Model</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>28</th>\n","      <td>Unknown Categoricals Handling</td>\n","      <td>least_frequent</td>\n","    </tr>\n","    <tr>\n","      <th>29</th>\n","      <td>Normalize</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>30</th>\n","      <td>Normalize Method</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>31</th>\n","      <td>Transformation</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>32</th>\n","      <td>Transformation Method</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>33</th>\n","      <td>PCA</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>34</th>\n","      <td>PCA Method</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>35</th>\n","      <td>PCA Components</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>36</th>\n","      <td>Ignore Low Variance</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>37</th>\n","      <td>Combine Rare Levels</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>38</th>\n","      <td>Rare Level Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>39</th>\n","      <td>Numeric Binning</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>40</th>\n","      <td>Remove Outliers</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>41</th>\n","      <td>Outliers Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>42</th>\n","      <td>Remove Multicollinearity</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>43</th>\n","      <td>Multicollinearity Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>44</th>\n","      <td>Remove Perfect Collinearity</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>45</th>\n","      <td>Clustering</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>46</th>\n","      <td>Clustering Iteration</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>47</th>\n","      <td>Polynomial Features</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>48</th>\n","      <td>Polynomial Degree</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>49</th>\n","      <td>Trignometry Features</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>50</th>\n","      <td>Polynomial Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>51</th>\n","      <td>Group Features</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>52</th>\n","      <td>Feature Selection</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>53</th>\n","      <td>Feature Selection Method</td>\n","      <td>classic</td>\n","    </tr>\n","    <tr>\n","      <th>54</th>\n","      <td>Features Selection Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>55</th>\n","      <td>Feature Interaction</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>56</th>\n","      <td>Feature Ratio</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>57</th>\n","      <td>Interaction Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>58</th>\n","      <td>Fix Imbalance</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>59</th>\n","      <td>Fix Imbalance Method</td>\n","      <td>SMOTE</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-483b71a0-88dc-4e72-ae8a-c8a0a8481383')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-483b71a0-88dc-4e72-ae8a-c8a0a8481383 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-483b71a0-88dc-4e72-ae8a-c8a0a8481383');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["clf1 = setup(data = df_train, target = 'damage_grade', session_id = 786, silent = True, use_gpu=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":330,"referenced_widgets":["aab6a30731294427a554c19ca62b9ffe","bb71c0b68dce4dd0b667d8a236a72031","89b676b046b5410797a52bd040723077"]},"id":"q430T9qpRbcg","outputId":"df64ced2-5286-49ea-fa72-589310463b97"},"outputs":[{"output_type":"display_data","data":{"text/plain":["IntProgress(value=0, description='Processing: ', max=74)"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"aab6a30731294427a554c19ca62b9ffe"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["                                                                   \n","                                                                   \n","Initiated  . . . . . . . . . . . . . . . . . .             01:38:15\n","Status     . . . . . . . . . . . . . . . . . .     Fitting 10 Folds\n","Estimator  . . . . . . . . . . . . . . . . . .  SVM - Linear Kernel"],"text/html":["\n","  <div id=\"df-8fbdcad6-c318-452f-bcc1-0fb0d05d8277\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","    <tr>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>Initiated</th>\n","      <td>. . . . . . . . . . . . . . . . . .</td>\n","      <td>01:38:15</td>\n","    </tr>\n","    <tr>\n","      <th>Status</th>\n","      <td>. . . . . . . . . . . . . . . . . .</td>\n","      <td>Fitting 10 Folds</td>\n","    </tr>\n","    <tr>\n","      <th>Estimator</th>\n","      <td>. . . . . . . . . . . . . . . . . .</td>\n","      <td>SVM - Linear Kernel</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8fbdcad6-c318-452f-bcc1-0fb0d05d8277')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8fbdcad6-c318-452f-bcc1-0fb0d05d8277 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8fbdcad6-c318-452f-bcc1-0fb0d05d8277');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["                        Model  Accuracy     AUC  Recall   Prec.      F1  \\\n","dt   Decision Tree Classifier    0.6409  0.6727  0.5919  0.6424  0.6416   \n","lr        Logistic Regression    0.5681  0.4974  0.3333  0.3227  0.4116   \n","nb                Naive Bayes    0.5654  0.5773  0.3343  0.3368  0.4122   \n","knn    K Neighbors Classifier    0.4933  0.5035  0.3357  0.4465  0.4591   \n","\n","      Kappa     MCC  TT (Sec)  \n","dt   0.3571  0.3572     4.267  \n","lr   0.0000  0.0000    16.572  \n","nb   0.0004  0.0020     0.385  \n","knn  0.0020  0.0021     9.412  "],"text/html":["\n","  <div id=\"df-183f9ce9-a476-409a-b3af-6e66a4679edd\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Model</th>\n","      <th>Accuracy</th>\n","      <th>AUC</th>\n","      <th>Recall</th>\n","      <th>Prec.</th>\n","      <th>F1</th>\n","      <th>Kappa</th>\n","      <th>MCC</th>\n","      <th>TT (Sec)</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>dt</th>\n","      <td>Decision Tree Classifier</td>\n","      <td>0.6409</td>\n","      <td>0.6727</td>\n","      <td>0.5919</td>\n","      <td>0.6424</td>\n","      <td>0.6416</td>\n","      <td>0.3571</td>\n","      <td>0.3572</td>\n","      <td>4.267</td>\n","    </tr>\n","    <tr>\n","      <th>lr</th>\n","      <td>Logistic Regression</td>\n","      <td>0.5681</td>\n","      <td>0.4974</td>\n","      <td>0.3333</td>\n","      <td>0.3227</td>\n","      <td>0.4116</td>\n","      <td>0.0000</td>\n","      <td>0.0000</td>\n","      <td>16.572</td>\n","    </tr>\n","    <tr>\n","      <th>nb</th>\n","      <td>Naive Bayes</td>\n","      <td>0.5654</td>\n","      <td>0.5773</td>\n","      <td>0.3343</td>\n","      <td>0.3368</td>\n","      <td>0.4122</td>\n","      <td>0.0004</td>\n","      <td>0.0020</td>\n","      <td>0.385</td>\n","    </tr>\n","    <tr>\n","      <th>knn</th>\n","      <td>K Neighbors Classifier</td>\n","      <td>0.4933</td>\n","      <td>0.5035</td>\n","      <td>0.3357</td>\n","      <td>0.4465</td>\n","      <td>0.4591</td>\n","      <td>0.0020</td>\n","      <td>0.0021</td>\n","      <td>9.412</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-183f9ce9-a476-409a-b3af-6e66a4679edd')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-183f9ce9-a476-409a-b3af-6e66a4679edd button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-183f9ce9-a476-409a-b3af-6e66a4679edd');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}],"source":["%%time\n","best_model = compare_models()"]},{"cell_type":"code","source":["Ensemble_Model = blend_models(compare_models(n_select = 5), method = 'soft')"],"metadata":{"id":"Edh5hjV73fI0"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KPJyYzIJSdPm"},"outputs":[],"source":["df_test_values = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/test_values.csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NVNoVDDXTCNC"},"outputs":[],"source":["predict_model(Ensemble_Model, data=df_test_values).Label.value_counts()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"i8PTouBzTFZp"},"outputs":[],"source":["Ensemble_Model"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6NNwiHNHTIRI"},"outputs":[],"source":["plot_model(Ensemble_Model, plot = 'confusion_matrix')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EaZFD8Ok3IQK"},"outputs":[],"source":["plot_model(Ensemble_Model, plot = 'feature_all')"]},{"cell_type":"code","source":["plot_model(Ensemble_Model, plot = 'auc')"],"metadata":{"id":"Uv0oWV0pFGBZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EwLE8ffm3mw0"},"outputs":[],"source":["plot_model(Ensemble_Model, plot = 'parameter')"]},{"cell_type":"code","source":["plot_model(Ensemble_Model, plot = 'error')"],"metadata":{"id":"suMZP8qDt8a3"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HDtDpTO3TK6Q"},"outputs":[],"source":["plot_model(Ensemble_Model, plot='boundary')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PwiFUHEzTaU-"},"outputs":[],"source":["final_knn = finalize_model(Ensemble_Model)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Y18wtc8mTb41"},"outputs":[],"source":["save_model(final_knn,\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/Ensemble_Model_Soft\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uDHNC7-HTd1T"},"outputs":[],"source":["saved_final_knn = load_model(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/Ensemble_Model_Soft\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"txQPfE6qTfc_"},"outputs":[],"source":["predictions = predict_model(saved_final_knn, data=df_test_values)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hqls0pygTg1_"},"outputs":[],"source":["predictions.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"o_CO2cqNTwDt"},"outputs":[],"source":["target = []\n","\n","for n in predictions.Label:\n","    if n == 0:\n","        target.append(1)\n","    elif n == 1:\n","        target.append(2)\n","    elif n == 2:\n","        target.append(3)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3UiILZyPTxw5"},"outputs":[],"source":["predictions[\"damage_grade\"] = target"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wgcf921dTzSd"},"outputs":[],"source":["predictions[[\"building_id\",\"damage_grade\"]].to_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/Ensemble.csv\", index=False)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8QCQ5TO6T4ya"},"outputs":[],"source":[""]},{"cell_type":"markdown","source":["# Treinamento 2"],"metadata":{"id":"qmlaJU686DpQ"}},{"cell_type":"code","source":["Ensemble_Model = blend_models(compare_models(n_select = 5), method = 'hard')"],"metadata":{"id":"cbozOx0c6FYN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_test_values = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/test_values.csv\")\n","predict_model(Ensemble_Model, data=df_test_values).Label.value_counts()"],"metadata":{"id":"RbdM07-i6RrK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["Ensemble_Model"],"metadata":{"id":"u72g5BmI6ZVF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["final_knn = finalize_model(Ensemble_Model)"],"metadata":{"id":"0vsc8ejR6g0o"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["save_model(final_knn,\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/Ensemble_Model_Hard\")"],"metadata":{"id":"kSRaawEE6nqm"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["saved_final_knn = load_model(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/Ensemble_Model_Hard\")"],"metadata":{"id":"uUNeiSGT6rTN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["predictions = predict_model(saved_final_knn, data=df_test_values)"],"metadata":{"id":"whv_ep-F6sdv"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["predictions.head()"],"metadata":{"id":"m_ix0Ol36t_d"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["target = []\n","\n","for n in predictions.Label:\n","    if n == 0:\n","        target.append(1)\n","    elif n == 1:\n","        target.append(2)\n","    elif n == 2:\n","        target.append(3)"],"metadata":{"id":"CzvOjzfx6vPJ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["predictions[\"damage_grade\"] = target"],"metadata":{"id":"hVMn32n36w2X"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["predictions[[\"building_id\",\"damage_grade\"]].to_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/Ensemble_Hard.csv\", index=False)"],"metadata":{"id":"3031kSLL6yIe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["plot_model(Ensemble_Model, plot = 'confusion_matrix')"],"metadata":{"id":"A_rnga3964SH"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["plot_model(Ensemble_Model, plot = 'feature_all')"],"metadata":{"id":"9uz7AYN465cZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["plot_model(Ensemble_Model, plot = 'auc')"],"metadata":{"id":"oXpXkS2D68ED"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["plot_model(Ensemble_Model, plot = 'parameter')"],"metadata":{"id":"EQq7toK56-ew"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["plot_model(Ensemble_Model, plot = 'error')"],"metadata":{"id":"x0AoShbk7Ah9"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["plot_model(Ensemble_Model, plot='boundary')"],"metadata":{"id":"FcJoIGav7CjK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"b5lEbahP7Kye"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"collapsed_sections":["EzuQlWAIdlLY","8nLeEBX0c9eZ","u8haITyvc_O2","ZDQGscRmgk8S","S8SA_6BDgrAF","GQPTyOlzK7XZ","aQo1b7rFCV23"],"name":"Treinamento - Blend Models","provenance":[],"authorship_tag":"ABX9TyPBmeKMaHItlLum+yHaPxzA"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"cdf0189aa6e1416db336200608e76c50":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"IntProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"Processing: ","description_tooltip":null,"layout":"IPY_MODEL_4764c84e817f4f848489bca3842e065a","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ecd5107fab5c4e6c8e085d6f61ac8bcb","value":3}},"4764c84e817f4f848489bca3842e065a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ecd5107fab5c4e6c8e085d6f61ac8bcb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"aab6a30731294427a554c19ca62b9ffe":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"IntProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"Processing: ","description_tooltip":null,"layout":"IPY_MODEL_bb71c0b68dce4dd0b667d8a236a72031","max":74,"min":0,"orientation":"horizontal","style":"IPY_MODEL_89b676b046b5410797a52bd040723077","value":25}},"bb71c0b68dce4dd0b667d8a236a72031":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"89b676b046b5410797a52bd040723077":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}}}}},"nbformat":4,"nbformat_minor":0}